<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Z1N Protocol – Live Stats</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex,nofollow" />

  <style>
    :root{
      --bg:#050812;
      --card-bg:#020617;
      --text-main:#ffffff;
      --text-soft:#8f9ab5;
      --accent:#66d69a;
      --accent-soft:#3a9f63;
      --card-border:rgba(148,163,184,0.25);

      /* Artefact intent colors */
      --C:#4CAF50;
      --I:#F44336;
      --K:#FFEB3B;
      --S:#2196F3;
    }

    *{ box-sizing:border-box; margin:0; padding:0; }

    html{
      scrollbar-gutter: stable;
      overflow-y: scroll;
      scroll-behavior: smooth;
    }

    body{
      background:var(--bg);
      color:var(--text-main);
      font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
    }

    a{ color:inherit; text-decoration:none; }
    a:hover{ opacity:0.9; }

    /* HEADER (shared) */
    header{
      height:72px;
      display:flex;
      align-items:center;
      justify-content:center;
      border-bottom:1px solid rgba(255,255,255,0.05);
      margin-bottom:20px;
    }

    .nav-inner{
      width:100%;
      max-width:1200px;
      margin:0 auto;
      padding:0 24px;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }

    .logo-wrap{ display:flex; align-items:center; gap:8px; }

    .logo-link{ display:inline-flex; align-items:center; gap:8px; }

    .logo-dot{
      width:24px; height:24px; border-radius:999px;
      border:1px solid rgba(255,255,255,0.35);
      display:flex; align-items:center; justify-content:center;
      font-size:14px; line-height:1;
    }

    .logo-text{
      font-size:11px;
      letter-spacing:0.18em;
      text-transform:uppercase;
      opacity:0.7;
    }

    .nav-links{
      display:flex;
      gap:22px;
      font-size:13px;
      opacity:0.85;
    }

    .nav-links a{ position:relative; }
    .nav-links a.active{ color:var(--accent); }

    .nav-links a.active::after{
      content:"";
      position:absolute;
      left:0;
      bottom:-4px;
      width:100%;
      height:2px;
      border-radius:999px;
      background:linear-gradient(to right,var(--accent),var(--accent-soft));
    }

    @media(max-width:900px){
      .nav-inner{ padding:0 16px; }
      .nav-links{
        font-size:12px;
        gap:14px;
        flex-wrap:wrap;
        justify-content:flex-end;
      }
    }

    /* PAGE */
    .page{
      max-width:1200px;
      margin:0 auto;
      padding:40px 24px 72px;
    }
    @media(max-width:900px){
      .page{ padding:32px 18px 56px; }
    }

    h1{
      font-size:40px;
      margin:0 0 10px 0;
      letter-spacing:-0.02em;
    }

    .lead{
      font-size:17px;
      opacity:0.85;
      line-height:1.65;
      margin-bottom:8px;
      max-width:900px;
    }

    .lead-small{
      font-size:14px;
      opacity:0.7;
      line-height:1.65;
      margin-top:4px;
      margin-bottom:28px;
      max-width:900px;
    }

    /* ====== TOP LEGEND (like artefact) ====== */
    .intent-legend{
      width:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:6px;
      margin: 8px 0 14px;
      user-select:none;
    }

    .intent-legend .title{
      font-size:13px;
      color:var(--text-soft);
      opacity:0.95;
    }

    .intent-legend .row{
      display:flex;
      gap:18px;
      align-items:center;
      justify-content:center;
      font-size:14px;
      letter-spacing:0.02em;
    }

    .intent-legend .c{ color:var(--C); }
    .intent-legend .i{ color:var(--I); }
    .intent-legend .k{ color:var(--K); }
    .intent-legend .s{ color:var(--S); }

    /* ====== DONUT DASHBOARD ====== */
    .donut-grid{
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap:16px;
      margin-bottom: 18px;
    }

    .donut-card{
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 18px;
      padding: 14px 14px 16px;
      position:relative;
      overflow:hidden;
      cursor:pointer;
      transition: transform 220ms ease, box-shadow 220ms ease, border-color 220ms ease;
    }

    .donut-card::before{
      content:"";
      position:absolute;
      inset:-1px;
      pointer-events:none;
      border-radius:18px;
      background: radial-gradient(circle at top, rgba(102,214,154,0.10), rgba(2,6,23,0) 62%);
      opacity:0.85;
    }

    .donut-card > *{ position:relative; }

    .donut-top{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }

    .donut-top .label{
      font-size:11px;
      letter-spacing:0.16em;
      text-transform:uppercase;
      color: rgba(255,255,255,0.75);
      opacity:0.9;
    }

    .donut-top .sub{
      font-size:12px;
      color: var(--text-soft);
      white-space:nowrap;
    }

    .donut-mid{
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 4px 0 2px;
    }

    .donut-svg{
      width: 150px;
      height: 150px;
      display:block;
    }

    .donut-center-title{
      font-size:12px;
      fill:#d5d9e8;
      opacity:0.95;
    }
    .donut-center-sub{
      font-size:11px;
      fill: var(--text-soft);
    }
    .donut-center-win{
      font-size:14px;
      font-weight:700;
      fill:#ffffff;
    }

    .donut-card:hover{
      transform: translateY(-2px);
      border-color: rgba(102,214,154,0.45);
      box-shadow:
        0 6px 18px rgba(0,0,0,0.35),
        0 0 0 1px rgba(102,214,154,0.14),
        0 0 18px rgba(102,214,154,0.10);
    }

    /* ACTIVE donut clearly */
    .donut-card.active{
      border-color: rgba(102,214,154,0.75);
      box-shadow:
        0 10px 28px rgba(0,0,0,0.45),
        0 0 0 1px rgba(102,214,154,0.20),
        0 0 26px rgba(102,214,154,0.16);
      transform: translateY(-1px);
    }

    /* Mobile swipe */
    .donut-swipe{
      display:none;
      margin-bottom: 14px;
    }

    .swipe-track{
      display:flex;
      gap:14px;
      overflow-x:auto;
      padding: 2px 2px 12px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
    }

    .swipe-track::-webkit-scrollbar{ height:10px; }
    .swipe-track::-webkit-scrollbar-thumb{
      background: rgba(148,163,184,0.25);
      border-radius:999px;
    }
    .swipe-track::-webkit-scrollbar-track{
      background: rgba(255,255,255,0.03);
      border-radius:999px;
    }

    .donut-card.swipe{
      flex: 0 0 86%;
      scroll-snap-align: start;
    }

    .swipe-hint{
      font-size:12px;
      color: var(--text-soft);
      margin-top: 6px;
      opacity:0.9;
      text-align:center;
    }

    @media(max-width:900px){
      .donut-grid{ display:none; }
      .donut-swipe{ display:block; }
    }

    /* ====== FIELD CARDS (dynamic) ====== */
    .field-cards{
      margin-top: 10px;
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap:16px;
      width:100%;
    }

    .field-card{
      background:var(--card-bg);
      border-radius:16px;
      border:1px solid var(--card-border);
      padding:14px 14px 16px;
      font-size:13px;
      transition:
        border-color 220ms ease,
        box-shadow 220ms ease,
        transform 220ms ease,
        background-color 220ms ease;
      position:relative;
      overflow:hidden;
    }

    .field-card::before{
      content:"";
      position:absolute;
      inset:-1px;
      pointer-events:none;
      border-radius:16px;
      background: radial-gradient(circle at top, rgba(102,214,154,0.08), rgba(2,6,23,0.0) 62%);
      opacity:0.9;
    }
    .field-card > *{ position:relative; }

    .fc-label{
      font-size:11px;
      letter-spacing:0.16em;
      text-transform:uppercase;
      opacity:0.55;
      margin-bottom:6px;
    }

    .fc-value{
      font-size:18px;
      font-weight:600;
      margin-bottom:4px;
    }

    .fc-sub{
      font-size:12px;
      opacity:0.75;
      line-height:1.55;
    }

    .field-card:hover{
      transform: translateY(-2px);
      border-color: rgba(102,214,154,0.35);
      box-shadow:
        0 6px 18px rgba(0,0,0,0.30),
        0 0 18px rgba(102,214,154,0.10);
      background-color: rgba(2,6,23,0.92);
    }

    @media(max-width:900px){
      .field-cards{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media(max-width:600px){
      .field-cards{ grid-template-columns: 1fr; }
    }

    /* ====== FIELD SIGNAL (MAS vibe) ====== */
    .field-signal{
      margin-top: 18px;
      background: var(--card-bg);
      border-radius: 18px;
      border: 1px solid var(--card-border);
      padding: 18px 18px 18px;
      overflow:hidden;
      position:relative;
    }

    .field-signal::before{
      content:"";
      position:absolute;
      inset:-1px;
      pointer-events:none;
      border-radius:18px;
      background: radial-gradient(circle at top, rgba(102,214,154,0.10), rgba(2,6,23,0.0) 65%);
      opacity:0.9;
    }
    .field-signal > *{ position:relative; }

    .fs-top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 10px;
    }

    .fs-title{
      font-size:13px;
      color: var(--text-soft);
      font-weight:600;
      letter-spacing:0.02em;
    }

    .fs-epoch{
      font-size:12px;
      color: rgba(255,255,255,0.75);
      opacity:0.9;
      border:1px solid rgba(148,163,184,0.22);
      padding:6px 10px;
      border-radius:999px;
      background: rgba(255,255,255,0.02);
      white-space:nowrap;
    }

    .fs-quote{
      font-size:16px;
      line-height:1.65;
      opacity:0.95;
      max-width: 980px;
    }

    .fs-sub{
      margin-top: 10px;
      font-size:12px;
      color: var(--text-soft);
      opacity:0.85;
    }

    /* FOOTER */
    footer{
      border-top:1px solid rgba(255,255,255,0.05);
      padding:20px;
      font-size:12px;
      text-align:center;
      opacity:0.85;
    }

    footer .tagline{
      margin-bottom:6px;
      font-size:13px;
    }

    footer .links{
      display:flex;
      justify-content:center;
      gap:18px;
      font-size:13px;
    }

    @media (prefers-reduced-motion: reduce){
      *{ scroll-behavior: auto !important; }
      .donut-card, .field-card{ transition:none; }
    }
  </style>
</head>

<body>
<header>
  <div class="nav-inner">
    <div class="logo-wrap">
      <a href="index.html" class="logo-link" aria-label="Z1N Protocol home">
        <div class="logo-dot">Ω</div>
        <div class="logo-text">Z1N PROTOCOL</div>
      </a>
    </div>

    <nav class="nav-links">
      <a href="about.html">About</a>
      <a href="live-stats.html" class="active">Live Stats</a>
      <a href="artefacts.html">Artefacts</a>
      <a href="nbi-artefacts.html">4 NBIs</a>
      <a href="mint-key.html">Mint your Key</a>
    </nav>
  </div>
</header>

<main class="page">
  <h1>Live stats of the field</h1>

  <p class="lead">
    The field is readable when it’s felt through signals first.
  </p>

  <p class="lead-small">
    Choose a lens. The cards below will shift to match it.
  </p>

  <!-- SINGLE legend like artefact -->
  <div class="intent-legend" aria-label="Intent legend">
    <div class="title">Intent mix across epochs</div>
    <div class="row">
      <span class="c">ΩC</span>
      <span class="i">ΩI</span>
      <span class="k">ΩK</span>
      <span class="s">ΩS</span>
    </div>
  </div>

  <!-- Desktop donuts -->
  <section class="donut-grid" aria-label="Intent mix donuts (desktop)">
    <article class="donut-card" data-key="current" data-window="Current epoch" data-sub="epoch now"
      data-c="23" data-i="18" data-k="39" data-s="20"></article>

    <article class="donut-card" data-key="21" data-window="21 epochs" data-sub="short lens"
      data-c="15" data-i="22" data-k="44" data-s="19"></article>

    <article class="donut-card" data-key="210" data-window="210 epochs" data-sub="pattern lens"
      data-c="12" data-i="19" data-k="47" data-s="22"></article>

    <article class="donut-card" data-key="total" data-window="Total epochs" data-sub="field memory"
      data-c="7" data-i="14" data-k="51" data-s="28"></article>
  </section>

  <!-- Mobile swipe donuts -->
  <section class="donut-swipe" aria-label="Intent mix donuts (mobile swipe)">
    <div class="swipe-track" id="swipeTrack">
      <article class="donut-card swipe" data-key="current" data-window="Current epoch" data-sub="epoch now"
        data-c="23" data-i="18" data-k="39" data-s="20"></article>

      <article class="donut-card swipe" data-key="21" data-window="21 epochs" data-sub="short lens"
        data-c="15" data-i="22" data-k="44" data-s="19"></article>

      <article class="donut-card swipe" data-key="210" data-window="210 epochs" data-sub="pattern lens"
        data-c="12" data-i="19" data-k="47" data-s="22"></article>

      <article class="donut-card swipe" data-key="total" data-window="Total epochs" data-sub="field memory"
        data-c="7" data-i="14" data-k="51" data-s="28"></article>
    </div>
    <div class="swipe-hint">Swipe → to change lens (tap to select)</div>
  </section>

  <!-- Dynamic field cards (default: Total epochs) -->
  <section class="field-cards" aria-label="Field cards">
    <div class="field-card">
      <div class="fc-label">Keys awakened</div>
      <div class="fc-value" id="vKeys">—</div>
      <div class="fc-sub" id="sKeys">—</div>
    </div>

    <div class="field-card">
      <div class="fc-label">PoG signals</div>
      <div class="fc-value" id="vSignals">—</div>
      <div class="fc-sub" id="sSignals">—</div>
    </div>

    <div class="field-card">
      <div class="fc-label">% signals attested</div>
      <div class="fc-value" id="vAttested">—</div>
      <div class="fc-sub" id="sAttested">—</div>
    </div>

    <div class="field-card">
      <div class="fc-label">Artefacts minted</div>
      <div class="fc-value" id="vArtefacts">—</div>
      <div class="fc-sub" id="sArtefacts">—</div>
    </div>
  </section>

  <!-- Field signal -->
  <section class="field-signal" aria-label="Field PoG signal">
    <div class="fs-top">
      <div class="fs-title" id="fsTitle">Field Signal</div>
      <div class="fs-epoch" id="fsEpoch">Epoch —</div>
    </div>
    <div class="fs-quote" id="fsQuote">"—"</div>
    <div class="fs-sub" id="fsSub">—</div>
  </section>

</main>

<footer>
  <div class="tagline">Your presence is real · The Field remembers</div>
  <div class="links">
    <a href="https://github.com/z1nprotocol" target="_blank" rel="noreferrer">GitHub</a>
    <a href="https://x.com/z1n_AI" target="_blank" rel="noreferrer">X</a>
  </div>
</footer>

<script>
  (function () {
    const COLORS = { C: "#4CAF50", I: "#F44336", K: "#FFEB3B", S: "#2196F3" };
    const ORDER = ["C","I","K","S"];
    const r = 51;
    const circumference = 2 * Math.PI * r;

    // Placeholder data per lens (swap later with real on-chain/indexer)
    const LENS_DATA = {
      current: {
        cards: {
          keys: { value: "7 842", sub: "Same total, but read as “present context”." },
          signals: { value: "1 284", sub: "Signals resonating in the current breath (example)." },
          attested: { value: "37%", sub: "Share of signals that received attestation (example)." },
          artefacts: { value: "19", sub: "Minted this epoch (example)." }
        },
        signal: { epoch: 42, quote: "De ruimte waar ΩS ademt", sub: "Most attested signal of the previous epoch (placeholder)." }
      },
      "21": {
        cards: {
          keys: { value: "7 842", sub: "Keys do not change often. Lens changes interpretation." },
          signals: { value: "8 420", sub: "Signals in the last 21 epochs (example)." },
          attested: { value: "41%", sub: "Attestation rate in the short lens (example)." },
          artefacts: { value: "112", sub: "Minted in last 21 epochs (example)." }
        },
        signal: { epoch: 41, quote: "Waar ΩK bouwt, blijft ΩC nabij", sub: "Short-lens field echo (placeholder)." }
      },
      "210": {
        cards: {
          keys: { value: "7 842", sub: "A stable count; meaning shifts with the horizon." },
          signals: { value: "14 220", sub: "Signals across the last 210 epochs (example)." },
          attested: { value: "46%", sub: "Attestation rate in the pattern lens (example)." },
          artefacts: { value: "880", sub: "Minted in last 210 epochs (example)." }
        },
        signal: { epoch: 35, quote: "ΩI kijkt terug — en kiest opnieuw", sub: "Pattern-lens resonance (placeholder)." }
      },
      total: {
        cards: {
          keys: { value: "7 842", sub: "All awakened Keys across the protocol (placeholder)." },
          signals: { value: "14 220", sub: "All PoG signals ever sent (placeholder)." },
          attested: { value: "44%", sub: "Total share of signals with ≥1 attestation (example)." },
          artefacts: { value: "1 842", sub: "All minted artefacts so far (placeholder)." }
        },
        signal: { epoch: 175, quote: "De stilte tussen attesten is ook een stem", sub: "Field MAS / PoG signal (placeholder)." }
      }
    };

    function dominant(intents){
      const entries = Object.entries(intents).sort((a,b) => b[1]-a[1]);
      const [key, pct] = entries[0];
      return { key, pct, color: COLORS[key] };
    }

    function buildDonutSVG(intents, titleTop, titleBottom){
      const sum = intents.C + intents.I + intents.K + intents.S;
      const safe = sum === 0 ? {C:25,I:25,K:25,S:25} : {
        C: (intents.C / sum) * 100,
        I: (intents.I / sum) * 100,
        K: (intents.K / sum) * 100,
        S: (intents.S / sum) * 100,
      };

      const win = dominant({
        C: Math.round(safe.C),
        I: Math.round(safe.I),
        K: Math.round(safe.K),
        S: Math.round(safe.S),
      });

      let offsetDeg = -90;
      const segments = ORDER.map((k) => {
        const pct = safe[k];
        const arc = (pct / 100) * circumference;
        const dasharray = `${arc.toFixed(1)} ${(circumference - arc).toFixed(1)}`;
        const seg = { key:k, dasharray, rotate: offsetDeg };
        offsetDeg += (pct / 100) * 360;
        return seg;
      });

      return `
        <svg class="donut-svg" viewBox="0 0 140 140" xmlns="http://www.w3.org/2000/svg" aria-label="Intent donut">
          <defs>
            <radialGradient id="donutBg" cx="50%" cy="40%" r="70%">
              <stop offset="0%" stop-color="#0b101b"/>
              <stop offset="100%" stop-color="#1c2534"/>
            </radialGradient>
          </defs>

          <circle cx="70" cy="70" r="62" fill="url(#donutBg)"></circle>
          <circle cx="70" cy="70" r="43" fill="#0f141f"></circle>

          <circle cx="70" cy="70" r="${r}"
                  fill="none" stroke="#252c3b" stroke-width="11"
                  transform="rotate(-90 70 70)"></circle>

          ${segments.map(s => `
            <circle cx="70" cy="70" r="${r}"
                    fill="none" stroke="${COLORS[s.key]}" stroke-width="11"
                    stroke-linecap="butt"
                    stroke-dasharray="${s.dasharray}"
                    transform="rotate(${s.rotate} 70 70)"></circle>
          `).join("")}

          <text x="70" y="61" text-anchor="middle" class="donut-center-title">${titleTop}</text>
          <text x="70" y="77" text-anchor="middle" class="donut-center-sub">${titleBottom}</text>
          <text x="70" y="99" text-anchor="middle" class="donut-center-win">
            <tspan fill="${win.color}">Ω${win.key}</tspan>
            <tspan fill="#ffffff"> ${win.pct}%</tspan>
          </text>
        </svg>
      `;
    }

    function renderCard(card){
      const windowLabel = card.getAttribute("data-window") || "Window";
      const sub = card.getAttribute("data-sub") || "";
      const intents = {
        C: Number(card.getAttribute("data-c") || 0),
        I: Number(card.getAttribute("data-i") || 0),
        K: Number(card.getAttribute("data-k") || 0),
        S: Number(card.getAttribute("data-s") || 0),
      };

      const topLabel =
        windowLabel.includes("21") ? "Last 21" :
        windowLabel.includes("210") ? "Last 210" :
        windowLabel.includes("Total") ? "Total" : "Current";

      card.innerHTML = `
        <div class="donut-top">
          <div class="label">${windowLabel}</div>
          <div class="sub">${sub}</div>
        </div>

        <div class="donut-mid">
          ${buildDonutSVG(intents, topLabel, "Epochs")}
        </div>
      `;
    }

    function setActiveLens(lensKey){
      // active class on ALL donuts with same data-key
      document.querySelectorAll(".donut-card").forEach(el => {
        el.classList.toggle("active", el.getAttribute("data-key") === lensKey);
      });

      const data = LENS_DATA[lensKey] || LENS_DATA.total;

      // Cards
      document.getElementById("vKeys").textContent = data.cards.keys.value;
      document.getElementById("sKeys").textContent = data.cards.keys.sub;

      document.getElementById("vSignals").textContent = data.cards.signals.value;
      document.getElementById("sSignals").textContent = data.cards.signals.sub;

      document.getElementById("vAttested").textContent = data.cards.attested.value;
      document.getElementById("sAttested").textContent = data.cards.attested.sub;

      document.getElementById("vArtefacts").textContent = data.cards.artefacts.value;
      document.getElementById("sArtefacts").textContent = data.cards.artefacts.sub;

      // Field signal
      document.getElementById("fsEpoch").textContent = "Epoch " + data.signal.epoch;
      document.getElementById("fsQuote").textContent = `"${data.signal.quote}"`;
      document.getElementById("fsSub").textContent = data.signal.sub;
    }

    // Render all donuts
    document.querySelectorAll(".donut-card").forEach(card => {
      renderCard(card);
      card.addEventListener("click", () => {
        const key = card.getAttribute("data-key") || "total";
        setActiveLens(key);
      });
    });

    // Default landing: TOTAL
    setActiveLens("total");

    // Mobile: if user scrolls/swipes but doesn't tap, keep selection as-is.
    // (We keep "tap to select" for clarity and avoid unexpected changes.)
  })();
</script>

</body>
</html>
